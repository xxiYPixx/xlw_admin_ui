# 管理端前端测试计划

## 目标
- 确保管理端前端核心流程可用、接口对接正确、页面交互稳定。
- 覆盖单元测试与端到端（E2E）测试，形成可持续的回归能力。

## 范围
- 登录与鉴权（登录、退出、未登录拦截）。
- 用户管理（查询、分页、新增、编辑、重置密码、删除、详情）。
- 商品管理（查询、分页、新增、编辑、上下架、入库、兑换状态/兑换价、删除、详情）。
- 订单管理（查询、分页、状态变更、支付变更、退款流转、删除、详情）。
- 配送费用（列表、编辑）。
- 折扣规则（列表、查询、增删改、详情）。
- 商品分类（列表、查询、增删改）。

## 依赖与环境
- 前端：Vite + Vue3 + Element Plus + Pinia + Vue Router + Axios。
- 后端：按 `doc/xlw-apiV1.md` 提供真实接口或稳定的测试环境。
- 数据：准备可重复测试的数据集（管理员账号、示例用户/商品/订单/分类/折扣规则）。

## 测试工具
- 单测：Vitest + @vue/test-utils。
- E2E：Playwright。

## 单元测试计划（UT）
### 1) 工具与工具函数
- `src/utils/form.ts`：toFormData 过滤/序列化规则。
- `src/api/types.ts`：isSuccess 对 0/200 的判断。

### 2) 状态与配置
- `src/stores/auth.ts`：登录成功/失败提示、token 写入与清理。
- `src/stores/category.ts`：列表解析、空数据容错。
- `src/config/menu.ts`：菜单项中英文校验、路由数量匹配。

### 3) 视图与组件
- 登录页文案与关键元素渲染。
- 列表页表头是否包含关键列（如用户、商品、订单）。
- 弹窗/抽屉显示条件（打开/关闭时机）。

### 4) API 模块
- 请求参数拼装逻辑（query/body）可通过 mock axios 校验。

## E2E 测试计划
### 1) 登录与鉴权
- 登录成功后跳转 `/users`，token 落库。
- 未登录访问 `/users` 等页面被重定向到 `/login`。
- 退出登录后回到登录页，受保护页面不可访问。

### 2) 用户管理
- 条件查询（phone/unit）与分页切换。
- 新增用户 -> 列表刷新 -> 详情可见。
- 编辑用户 -> 列表更新。
- 重置密码 -> 成功提示。
- 删除用户 -> 二次确认 -> 列表减少。

### 3) 商品管理
- 筛选（名称/分类/状态/可兑换）与分页。
- 新增商品 -> 列表刷新。
- 编辑商品 -> 列表更新。
- 入库/上下架/兑换状态/兑换价 -> 状态变化可见。
- 删除商品 -> 二次确认 -> 列表减少。

### 4) 订单管理
- 按多条件筛选 + 分页。
- 修改订单状态、支付状态后列表更新。
- 退款流程：标记待退款/拒绝/确认退款均提示成功。
- 删除订单 -> 二次确认 -> 列表减少。

### 5) 配送费用与折扣规则
- 配送费编辑保存后列表刷新。
- 折扣规则增删改查与分页正常。

### 6) 商品分类
- 分类查询、分页。
- 新增/编辑/删除分类 -> 列表更新。

## 测试数据准备
- 管理员账号：具备所有权限。
- 预置用户/商品/订单/分类/折扣规则：确保列表可检索、可分页。
- 订单状态覆盖：至少包含 0/1/4/7/8 等关键状态。

## 通过标准
- UT：核心工具/状态/页面渲染用例全通过。
- E2E：各模块关键流程全通过，失败率 0。
- 关键字段与交互符合 `doc/xlw-apiV1.md`。

## 风险与说明
- 列表返回字段可能随接口调整，应以 API 文档为准。
- E2E 依赖后端稳定性，建议提供独立测试环境。
- 对于涉及金额/折扣等输入，需与后端校验规则保持一致。
